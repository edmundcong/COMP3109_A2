#! /usr/bin/env bash

#=================================================================#
#                           automark.sh                           #
#                                                                 #
# Author: Nic H.                                                  #
# Date: 2016-Sep-12                                               #
#=================================================================#

set -e
set -u

# $1 is a directory containing your submission
# this line puts all your prolog code into 1 file
find $1/ -iname "*.pl" | xargs cat > assignment2.pl

# Find the prolog section of this file, skips the "BEGIN PROLOG
# SECTION" line, and pipe it into swipl
grep -A 9999 '^#BEGIN' $0 | tail -n +2 | swipl

# cleaning up after ourselves
rm assignment2.pl
exit 0

#BEGIN PROLOG SECION

writeln("Loading your submission"), [assignment2].

writeln("Checking Task 1"), completegrid(
    [[[1,1],[1,2],[1,3],[2,1],[2,2],[2,3],[3,1],[4,1],[4,2]],
     [[1,4],[2,4],[2,5],[2,6],[3,6],[3,7],[3,8],[4,8],[4,9]],
     [[1,5],[1,6],[1,7],[1,8],[1,9],[2,7],[2,8],[2,9],[3,9]],
     [[3,2],[3,3],[3,4],[3,5],[4,3],[5,1],[5,2],[5,3],[5,4]],
     [[4,4],[4,5],[4,6],[4,7],[5,5],[6,3],[6,4],[6,5],[6,6]],
     [[5,6],[5,7],[5,8],[5,9],[6,7],[7,5],[7,6],[7,7],[7,8]],
     [[6,1],[6,2],[7,2],[7,3],[7,4],[8,4],[8,5],[8,6],[9,6]],
     [[6,8],[6,9],[7,9],[8,7],[8,8],[8,9],[9,7],[9,8],[9,9]],
     [[7,1],[8,1],[8,2],[8,3],[9,1],[9,2],[9,3],[9,4],[9,5]]]).

writeln("Checking Task 2"), contiguousgrid(
    [[1,1],[1,2],[1,3],[2,1],[2,2],[2,3],[3,1],[4,1],[4,2]]).

writeln("Checking Task 3"), solve(
    [[[1,1],[1,2],[1,3],[2,1],[2,2],[2,3],[3,1],[4,1],[4,2]],
     [[1,4],[2,4],[2,5],[2,6],[3,6],[3,7],[3,8],[4,8],[4,9]],
     [[1,5],[1,6],[1,7],[1,8],[1,9],[2,7],[2,8],[2,9],[3,9]],
     [[3,2],[3,3],[3,4],[3,5],[4,3],[5,1],[5,2],[5,3],[5,4]],
     [[4,4],[4,5],[4,6],[4,7],[5,5],[6,3],[6,4],[6,5],[6,6]],
     [[5,6],[5,7],[5,8],[5,9],[6,7],[7,5],[7,6],[7,7],[7,8]],
     [[6,1],[6,2],[7,2],[7,3],[7,4],[8,4],[8,5],[8,6],[9,6]],
     [[6,8],[6,9],[7,9],[8,7],[8,8],[8,9],[9,7],[9,8],[9,9]],
     [[7,1],[8,1],[8,2],[8,3],[9,1],[9,2],[9,3],[9,4],[9,5]]],
    [[3,_,_,_,_,_,_,_,4],
     [_,_,2,_,6,_,1,_,_],
     [_,1,_,9,_,8,_,2,_],
     [_,_,5,_,_,_,6,_,_],
     [_,2,_,_,_,_,_,1,_],
     [_,_,9,_,_,_,8,_,_],
     [_,8,_,3,_,4,_,6,_],
     [_,_,4,_,1,_,9,_,_],
     [5,_,_,_,_,_,_,_,7]],
     X), maplist(writeln, X).